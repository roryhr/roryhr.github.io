<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>Enumerations</title>
        <link rel="stylesheet" href="./theme/css/main.css" />
        <meta name="description" content="I recently learned about Enums. Here's a fine ChatGPT example which is essentially the content of of Google search result. ChatGPT is like the old..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="./">Rory's Corner</a></h1>
                <nav><ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/archives">Articles</a></li>
                    <li><a href="/pages/about">About</a></li>
                    <li><a href="/pages/projects">Projects</a></li>
                    <li><a href="/pages/contact">Contact</a></li>
                    <li><a href="/images/donuts/donuts">Donuts</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="./enumerations.html" rel="bookmark"
           title="Permalink to Enumerations">Enumerations</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2023-10-06T00:00:00-07:00">
                Published: Fri 06 October 2023
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="./author/rory-hartong-redden.html">Rory Hartong-Redden</a>
        </address>
<p>In <a href="./category/blog.html">blog</a>.</p>
<p>tags: <a href="./tag/python.html">python</a> </p>
</footer><!-- /.post-info -->      <p>I recently learned about Enums. 
Here's a fine ChatGPT example which is essentially the content of of Google search result.
ChatGPT is like the old internet where you could read text on websites.</p>
<h2>ChatGPT</h2>
<p>Following is just verbatim output from the following request:</p>
<div class="highlight"><pre><span></span><code>➜<span class="w">  </span>~<span class="w"> </span>llm<span class="w"> </span><span class="s2">&quot;give me an example of using Enums in python&quot;</span>
</code></pre></div>

<p>Sure! Here's an example of using Enums in Python:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="c1"># Define an Enum class</span>
<span class="k">class</span> <span class="nc">Color</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">RED</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">GREEN</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">BLUE</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Accessing Enum members</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>                    <span class="c1"># Color.RED</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>               <span class="c1"># RED</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>              <span class="c1"># 1</span>

<span class="c1"># Iterating over Enum members</span>
<span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">Color</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

<span class="c1"># Checking Enum membership</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span> <span class="ow">in</span> <span class="n">Color</span><span class="p">)</span>           <span class="c1"># True</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">YELLOW</span> <span class="ow">in</span> <span class="n">Color</span><span class="p">)</span>        <span class="c1"># False</span>

<span class="c1"># Comparing Enum members</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span> <span class="o">==</span> <span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">)</span>       <span class="c1"># True</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span> <span class="o">==</span> <span class="n">Color</span><span class="o">.</span><span class="n">GREEN</span><span class="p">)</span>     <span class="c1"># False</span>

<span class="c1"># Enum as dictionary keys</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">:</span> <span class="s2">&quot;FF0000&quot;</span><span class="p">,</span>
    <span class="n">Color</span><span class="o">.</span><span class="n">GREEN</span><span class="p">:</span> <span class="s2">&quot;00FF00&quot;</span><span class="p">,</span>
    <span class="n">Color</span><span class="o">.</span><span class="n">BLUE</span><span class="p">:</span> <span class="s2">&quot;0000FF&quot;</span>
<span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">Color</span><span class="o">.</span><span class="n">RED</span><span class="p">])</span>            <span class="c1"># FF0000</span>
</code></pre></div>

<p>In this example, we define an enum class called "Color" with three members - RED, GREEN, and BLUE. We can access enum members using dot notation (e.g., Color.RED). We can also access the name and value of an enum member using the <code>name</code> and <code>value</code> properties.</p>
<p>We can iterate over all the enum members using a for loop. Enum membership can be checked using the <code>in</code> keyword.</p>
<p>Enum members can be compared using the equality operator (<code>==</code>). We can also use enums as dictionary keys, as shown in the last example.</p>
<h2>Back to me</h2>
<p>This is all great. My takeaway is that we can replace strings with Enums across the codebase. The Color class enumerates color options and removes typos. There are two more things I want, however. </p>
<p>First, since this is an API interacting with other services, we need to be able to serialize to JSON. </p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;inspection&quot;</span><span class="p">:</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">VISUAL</span><span class="p">}))</span>
<span class="c1"># TypeError: Object of type Inspection is not JSON serializable</span>

<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;inspection&quot;</span><span class="p">:</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">VISUAL</span><span class="o">.</span><span class="n">value</span><span class="p">}))</span>
<span class="p">{</span><span class="s2">&quot;inspection&quot;</span><span class="p">:</span> <span class="s2">&quot;Visual Check&quot;</span><span class="p">}</span>
</code></pre></div>

<p>The default Enu, as you can see, is not serializable – but is value is. So all over the codebase we’d have to call <code>.value</code> whenever the Enum gets turned into JSON and that's not cool. </p>
<p>Well, can chatGPT help here? Maybe but in the time it'd take to fiddle with GPT I can do a Google search and get my answer on <a href="https://stackoverflow.com/questions/24481852/serialising-an-enum-member-to-json">StackOverflow</a>.
The trick is to inherit from str and Enum. </p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Inspection</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;JSON serializable inspection types with custom exception&quot;&quot;&quot;</span>


   <span class="n">VISUAL</span> <span class="o">=</span> <span class="s2">&quot;Visual Check&quot;</span>
   <span class="n">BASIC</span> <span class="o">=</span> <span class="s2">&quot;Basic Inspection&quot;</span>
   <span class="n">STANDARD</span> <span class="o">=</span> <span class="s2">&quot;Standard Inspection&quot;</span>
   <span class="n">ADVANCED</span> <span class="o">=</span> <span class="s2">&quot;Advanced Inspection&quot;</span>


<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;inspection&quot;</span><span class="p">:</span> <span class="n">Inspection</span><span class="o">.</span><span class="n">VISUAL</span><span class="p">}))</span>
<span class="c1"># {&quot;inspection&quot;: &quot;Visual Check&quot;}</span>
</code></pre></div>

<p>Boom! First problems solved and now the second problem....
A nice property of Enums is, like a dictionary, they raise an error if you try to make an Enum from an unknown value.
For Example: </p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">Inspection</span><span class="p">(</span><span class="s2">&quot;Just look it it real quick&quot;</span><span class="p">))</span>
<span class="c1"># ValueError: &#39;Just look it it real quick&#39; is not a valid Inspection</span>
</code></pre></div>

<p>This is nice but we want to raise a custom exception (whether we should have custom exceptions is a topic for another day)</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">test_unknown_inspection</span><span class="p">():</span>
   <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="n">MissingModelConfigError</span><span class="p">):</span>
       <span class="n">Inspection</span><span class="p">(</span><span class="s2">&quot;Give it a quick look&quot;</span><span class="p">)</span>
</code></pre></div>

<p>No problem because as we can see in stacktrace</p>
<div class="highlight"><pre><span></span><code>   <span class="mi">575</span>     <span class="nd">@classmethod</span>
    <span class="mi">576</span>     <span class="k">def</span> <span class="nf">_missing_</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="o">--&gt;</span> <span class="mi">577</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%r</span><span class="s2"> is not a valid </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
</code></pre></div>

<p>all we have to do is override the <code>_missing_</code> method.</p>
<h2>Result</h2>
<p>Now we're done</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Inspection</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;JSON serializable inspection types with custom exception&quot;&quot;&quot;</span>


   <span class="n">VISUAL</span> <span class="o">=</span> <span class="s2">&quot;Visual Check&quot;</span>
   <span class="n">BASIC</span> <span class="o">=</span> <span class="s2">&quot;Basic Inspection&quot;</span>
   <span class="n">STANDARD</span> <span class="o">=</span> <span class="s2">&quot;Standard Inspection&quot;</span>
   <span class="n">ADVANCED</span> <span class="o">=</span> <span class="s2">&quot;Advanced Inspection&quot;</span>


   <span class="nd">@classmethod</span>
   <span class="k">def</span> <span class="nf">_missing_</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
       <span class="k">raise</span> <span class="n">MissingModelConfigError</span><span class="p">(</span>
           <span class="n">missing_property</span><span class="o">=</span><span class="s2">&quot;inspection&quot;</span><span class="p">,</span> <span class="n">expected_value</span><span class="o">=</span><span class="n">value</span>
       <span class="p">)</span>
</code></pre></div>

<p>For this effort we don’t have to worry about typos or an unknown inspection sneaking in. 
All we need to care about is a subset of these defined inspections. 
Very cool!</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://www.chipy.org/">ChiPy</a></li>
                            <li><a href="http://baypiggies.net/">BayPIGies</a></li>
                            <li><a href="http://pyninsula.org/">Pyninsula</a></li>
                            <li><a href="http://sfpythonmeetup.com/">SF Python</a></li>
                            <li><a href="http://blog.kaggle.com/">No Free Hunch (Kaggle)</a></li>
                            <li><a href="http://efavdb.com/">EFAVDB</a></li>
                            <li><a href="https://www.wheresyoured.at/">Where's Your Ed At</a></li>
                            <li><a href="http://sisl.stanford.edu/">SISL</a></li>
                            <li><a href="https://adventofcode.com/">Advent of Code</a></li>
                            <li><a href="https://simonwillison.net/">Simon Willison’s Weblog</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://github.com/roryhr">Github</a></li>
                            <li><a href="https://www.linkedin.com/in/rory-hartong-redden">LinkedIn</a></li>
                            <li><a href="https://mastodon.social/@roryhr">Mastodon</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

<script defer src="https://cloud.umami.is/script.js" data-website-id="a1db9ef4-135a-4406-8304-f1ffa50665bc"></script>
</body>
</html>